#!/bin/sh

set -e

cd /home/dev/script/
rm -rf ../resources/data

python download_dataset.py ../resources/data
python download_auxiliary_dataset.py ../resources/data/aux

mkdir -p /home/dev/resources/data/aux/rosetta
mkdir -p /home/dev/resources/data/aux/conala
mkdir -p /home/dev/resources/data/aux/staqc

cd /home/dev/src/dataextraction/JavaDataExtraction/
mvn package
mvn exec:java -DXmx8G -D"exec.mainClass"="javaextract.RosettaExtractor" -D"exec.args"="../../../resources/data/aux/java_rosetta_code.csv ../../../resources/data/aux/rosetta/java_rosetta_data"

cd /home/dev/src/dataextraction/CSharpDataExtraction/
dotnet run --project RosettaCodeTokenExtractor/RosettaCodeTokenExtractor.csproj ../../../resources/data/aux/RosettaCodeData/Lang/C-sharp/ ../../../resources/data/aux/rosetta

cp /home/dev/resources/data/aux/conala-corpus/*.json /home/dev/resources/data/aux/conala/.
cp /home/dev/resources/data/aux/StackOverflow-Question-Code-Dataset/annotation_tool/data/code_solution_labeled_data/source/python*qid_by*.pickle /home/dev/resources/data/aux/staqc/.
cp -r -L /home/dev/resources/data/aux/RosettaCodeData/Lang/Python /home/dev/resources/data/aux/rosetta/
